<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>VR Комп'ютерна Архітектура</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-super-hands-component@3.0.1/dist/aframe-super-hands.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
</head>
<body>
<a-scene physics="debug: false" vr-mode-ui="enabled: true" shadow="type: pcfsoft" renderer="colorManagement: true">

    <!-- Освітлення -->
    <a-entity light="type: ambient; color: #AAA; intensity: 0.3"></a-entity>
    <a-entity light="type: directional; color: #FFF; intensity: 0.8; cast-shadow: true;
              shadow-camera-near: 2; shadow-camera-far: 20; shadow-map-width: 1024;
              shadow-map-height: 1024; shadow-bias: -0.001" 
              position="-1 3 1" rotation="-45 0 0"></a-entity>
    <a-entity light="type: directional; color: #FFF; intensity: 0.3" 
              position="1 2 1" rotation="-20 30 0"></a-entity>
    <a-entity light="type: point; color: #FFF; intensity: 0.6; distance: 8; decay: 1"
              position="0 2.5 0"></a-entity>

    <!-- Оточення -->
    <a-sky color="#ECECEC"></a-sky>

    <!-- Камера -->
    <a-entity id="player" movement-controls="speed: 0.1">
        <a-entity id="camera" 
                  camera="active: true" 
                  position="0 1.6 0"
                  look-controls="pointerLockEnabled: false">
        </a-entity>
    </a-entity>

    <!-- VR Руки (контролери) -->
    <a-entity hand-controls="hand: left; handModelStyle: lowPoly; color: #ffaaaa" super-hands></a-entity>
    <a-entity hand-controls="hand: right; handModelStyle: lowPoly; color: #aaaaff" super-hands></a-entity>

    <!-- Комп'ютерний корпус -->
    <a-entity id="case" 
              gltf-model="#case-model" 
              position="0 0.5 -2" 
              scale="0.5 0.5 0.5"
              grabbable
              stretchable
              hoverable
              shadow="receive: true; cast: true"
              class="clickable"
              data-component="Корпус комп'ютера"
              data-description="Захищає компоненти комп'ютера та забезпечує охолодження">
        <a-text value="Case" position="0 -0.5 0" color="black" align="center"></a-text>
    </a-entity>

    <!-- Інформаційна панель -->
    <a-entity id="info-panel" position="1.5 1.5 -2" visible="false">
        <a-plane color="#333" width="1.5" height="0.8" position="0 0 0" shadow="receive: true"></a-plane>
        <a-text id="component-name" value="" color="white" position="-0.7 0.3 0.01" width="1.4"></a-text>
        <a-text id="component-description" value="" color="white" position="-0.7 0 0.01" width="1.4" wrap-count="30"></a-text>
    </a-entity>

    <!-- Індикатор навантаження -->
    <a-entity id="load-indicator" position="0 2 -1.5">
        <a-text id="load-text" value="Навантаження: 0%" color="black" align="center"></a-text>
        <a-plane id="load-bar" color="green" width="2" height="0.2" position="0 -0.2 0" shadow="receive: true">
            <a-plane id="load-progress" color="lime" width="0" height="0.18" position="-1 0 0.01"></a-plane>
        </a-plane>
    </a-entity>

    <!-- Ассети моделей -->
    <a-assets>
        <a-asset-item id="cpu-model" src="models/cpu.glb"></a-asset-item>
        <a-asset-item id="motherboard-model" src="models/motherboard.glb"></a-asset-item>
        <a-asset-item id="ram-model" src="models/ram.glb"></a-asset-item>
        <a-asset-item id="gpu-model" src="models/gpu.glb"></a-asset-item>
        <a-asset-item id="psu-model" src="models/psu.glb"></a-asset-item>
        <a-asset-item id="case-model" src="models/case.glb"></a-asset-item>
        <a-asset-item id="fan-model" src="models/fan.glb"></a-asset-item>
        <a-asset-item id="hdd-model" src="models/hdd.glb"></a-asset-item>
    </a-assets>

    <!-- Скрипт -->
    <script>
        // Інформація про компоненти
        AFRAME.registerComponent('component-info', {
            init: function() {
                this.el.addEventListener('hover-start', () => {
                    const panel = document.querySelector('#info-panel');
                    panel.setAttribute('visible', true);
                    panel.setAttribute('position', {
                        x: this.el.object3D.position.x + 0.5,
                        y: this.el.object3D.position.y,
                        z: this.el.object3D.position.z
                    });
                    document.querySelector('#component-name').setAttribute('value', 
                        this.el.getAttribute('data-component'));
                    document.querySelector('#component-description').setAttribute('value', 
                        this.el.getAttribute('data-description'));
                });
                this.el.addEventListener('hover-end', () => {
                    document.querySelector('#info-panel').setAttribute('visible', false);
                });
            }
        });

        // Симуляція навантаження
        let load = 0;
        let loadDirection = 1;
        setInterval(() => {
            load += loadDirection * Math.random() * 5;
            if (load > 100) { load = 100; loadDirection = -1; }
            else if (load < 0) { load = 0; loadDirection = 1; }

            document.querySelector('#load-text').setAttribute('value', `Навантаження: ${Math.round(load)}%`);
            const progress = document.querySelector('#load-progress');
            progress.setAttribute('width', (load / 100) * 2);
            progress.setAttribute('color', load < 50 ? 'lime' : load < 80 ? 'yellow' : 'red');
        }, 500);

        // Активувати підказки для компонентів
        document.querySelectorAll('.clickable').forEach(el => {
            el.setAttribute('component-info', '');
        });
    </script>
</a-scene>
</body>
</html>
